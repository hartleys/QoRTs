<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Plot Gene-Body coverage distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for makePlot.genebody.coverage {QoRTs}"><tr><td>makePlot.genebody.coverage {QoRTs}</td><td align="right">R Documentation</td></tr></table>

<h2>
Plot Gene-Body coverage distribution
</h2>

<h3>Description</h3>

<p>Plots Gene-Body coverage distribution
</p>


<h3>Usage</h3>

<pre>
  makePlot.genebody(plotter, 
                  geneset = c("Overall","90-100","75-90","50-75","0-50"),
                  avgMethod = c("TotalCounts", "AvgPercentile"), 
                  plot.medians, 
                  plot.means = TRUE, 
                  debugMode, 
                  singleEndMode, 
                  ... )

  #NOTE: The preferred method to access the below functions
  #  is to use makeplot.genebody and set:
  #  avgMethod = "TotalCounts"
  #DEPRECIATED:
  makePlot.genebody.coverage(plotter, plot.medians,
                       plot.means = TRUE,  
                       debugMode, singleEndMode, ...)
  #DEPRECIATED:
  makePlot.genebody.coverage.UMQuartile(plotter, plot.medians, 
                       plot.means = TRUE, 
                       debugMode, singleEndMode, ...)
  #DEPRECIATED:
  makePlot.genebody.coverage.lowExpress(plotter, plot.medians, 
                       plot.means = TRUE, 
                       debugMode, singleEndMode, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>plotter</code></td>
<td>

<p>A <code>QoRT_Plotter</code> reference object. See <code><a href="build.plotter.html">build.plotter</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>geneset</code></td>
<td>

<p>The set of genes to plot the gene-body coverage over. Genes are grouped
into four quantiles by their by their total read counts: the 90-100 quantile,
the 75-90 quantile, the 50-75 quantile (or &quot;upper-middle quartile&quot;), and the
0-50 quantile. By default it will plot the overall gene-body coverage across
all genes.
</p>
</td></tr>
<tr valign="top"><td><code>avgMethod</code></td>
<td>

<p>The method used to generate average gene body coverage. 
</p>
<p>The &quot;TotalCounts&quot; (default) method simply takes the sum of each bin across all genes in the geneset,
then for each replicate normalizes the coverage into frequencies.
</p>
<p>The &quot;AvgPercentile&quot; calculates the coverage distribution across each percentile bin 
and normalizes the counts so they add up to 1, FOR EACH GENE, and 
THEN averages those values across all genes in the geneset. 
</p>
<p>The latter variant is experimental. the idea was for it to reduce the impact of 
highly-expressed genes and gain a better estimate of the degree of 5'/3' bias.
</p>
</td></tr>
<tr valign="top"><td><code>plot.medians</code></td>
<td>

<p>A logical value indicating whether or not to plot the median 
average for each bamfile at the bottom of the plot. 
Overrides <code>plot.means</code>.
</p>
</td></tr>
<tr valign="top"><td><code>plot.means</code></td>
<td>

<p>A logical value indicating whether or not to plot the mean 
average for each bamfile at the bottom of the plot.
</p>
</td></tr>
<tr valign="top"><td><code>debugMode</code></td>
<td>

<p>Logical. If TRUE, debugging data will be printed to the console.
</p>
</td></tr>
<tr valign="top"><td><code>singleEndMode</code></td>
<td>

<p>Logical. Determines whether the dataset consists of single-ended reads. 
By default this is determined from the data. Thus, this parameter should 
never need to be set by the user.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
 
<p>Arguments to be passed to methods, such as
<a href="../../graphics/html/par.html">graphical parameters</a> (see <code><a href="../../graphics/html/par.html">par</a></code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>x-axis: Gene-body quantile. By default this is broken up into
40 quantiles containing 2.5
</p>
<p>y-axis: Rate at which reads falls into the given quantile of the
genes' bodies.
</p>
<p><code>makePlot.genebody.coverage</code> plots the gene body coverage across all genes.
<code>makePlot.genebody.coverage.UMQuartile</code> plots the gene body coverage across the genes that fall in the upper-middle quartile of total expression for each sample-run (excluding genes with zero reads).
<code>makePlot.genebody.coverage.lowExpress</code> plots the gene body coverage across the genes that fall in the lower two quartiles of total expression for each sample-run (excluding genes with zero reads).
</p>


<h3>See Also</h3>

<p><code><a href="build.plotter.html">build.plotter</a></code>
</p>

<hr><div align="center">[Package <em>QoRTs</em> version 1.0.1 <a href="00Index.html">Index</a>]</div>
</body></html>
